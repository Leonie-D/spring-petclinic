pipeline {
    agent any
    stages {
        stage ('Download file') {
            steps {
                rtDownload (
                    // Obtain an Artifactory server instance, defined in Jenkins --> Manage Jenkins --> Configure System:
                    serverId: 'leonie',
                    spec: """{
                            "files": [
                                    {
                                        "pattern": "default-maven-local/*.jar",
                                        "target": "artifacts"
                                    }
                                ]
                            }"""
                )
            }
        }
        stage('Deploy') {
            script {
              sshPublisher(
                continueOnError: false, failOnError: true,
                publishers: [
                    sshPublisherDesc(
                        transfers: [
                            sshTransfer(
                                sourceFiles: "artifacts/*.jar",
                                removePrefix: "artifacts",
                                execCommand: ""
                            )
                        ])
                    ])
            }
        }
    }
}
